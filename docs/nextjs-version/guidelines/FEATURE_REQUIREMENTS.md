# 機能要件ドキュメント

このドキュメントは、smartsample ECサイトの機能要件を記録し、開発の進行に伴って継続的に更新します。

**最終更新日**: 2025-10-09

---

## 目次

1. [ナビゲーション機能](#ナビゲーション機能)
2. [キャンペーン機能](#キャンペーン機能)
3. [ユーザーアカウント管理](#ユーザーアカウント管理)
4. [UI/UXの改善](#uiuxの改善)

---

## ナビゲーション機能

### 1.1 パンくずリスト（Breadcrumb）

**要件ID**: NAV-001
**実装日**: 2025-10-09
**ステータス**: ✅ 完了

#### 概要
カテゴリーページやキャンペーンページで動的にパンくずリストを生成し、ユーザーの現在位置を明確に表示する。

#### 詳細要件

1. **URLパラメータからカテゴリー取得**
   - `/products?category=XXX` のクエリパラメータを解析
   - パンくずに「ホーム > 商品一覧 > カテゴリー名」と表示

2. **商品詳細ページでのカテゴリー表示**
   - 商品データからカテゴリーを取得
   - パンくずに「ホーム > 商品一覧 > カテゴリー名 > 商品名」と表示
   - カテゴリー名はクリック可能で、該当カテゴリーの商品一覧に遷移

3. **キャンペーンページ対応**
   - `/campaigns` パスのラベルを「キャンペーン一覧」として表示
   - キャンペーン詳細ページでは階層構造を明示

#### 実装ファイル
- `/src/components/common/Breadcrumb.tsx`

#### 技術仕様
- `useSearchParams` フックでURLパラメータを取得
- 動的ルーティング対応
- カスタムパスラベルマッピング

---

### 1.2 カテゴリードロップダウン

**要件ID**: NAV-002
**実装日**: 2025-10-09
**ステータス**: ✅ 完了

#### 概要
ヘッダーのナビゲーションバーに、マウスホバーで開くカテゴリードロップダウンメニューを実装。

#### 詳細要件

1. **カテゴリーアイコン**
   - 絵文字ではなく単色SVGアイコンを使用
   - 各カテゴリーに対応したアイコン:
     - オフィス用品: クリップアイコン
     - 文具: 鉛筆アイコン
     - 電化製品: モニターアイコン
     - 家具: 椅子アイコン
     - 収納用品: 箱アイコン
     - 帳簿・書籍: 本アイコン

2. **z-index階層管理**
   - HeroSlider: `z-0` (最下層)
   - Header: `z-40`
   - Navigation: `z-[60]`
   - Dropdown: `z-[9999]` (最上層)
   - ドロップダウンが他のコンテンツに隠れないように管理

3. **ユーザーインタラクション**
   - マウスホバーで自動的に開く（`onMouseEnter`）
   - マウスが離れると自動的に閉じる（`onMouseLeave`）
   - 矢印アイコンが開閉状態に応じて回転

#### 実装ファイル
- `/src/components/layout/Header.tsx`
- `/src/components/home/HeroSlider.tsx`

#### 技術仕様
- `useState` でドロップダウン開閉状態を管理
- Tailwind CSSのz-indexユーティリティクラスを使用
- トランジション効果で滑らかな開閉アニメーション

---

## キャンペーン機能

### 2.1 キャンペーンデータモデル

**要件ID**: CAMP-001
**実装日**: 2025-10-09
**ステータス**: ✅ 完了

#### 概要
キャンペーン情報を管理するデータモデルを定義し、一元管理する。

#### データ構造

```typescript
interface Campaign {
  id: string;              // 一意のキャンペーンID
  title: string;           // キャンペーンタイトル
  description: string;     // 詳細説明
  image: string;           // バナー画像パス
  startDate: string;       // 開始日（ISO 8601形式）
  endDate: string;         // 終了日（ISO 8601形式）
  featured: boolean;       // 注目キャンペーンフラグ
  category?: string;       // 関連カテゴリー（任意）
  products?: string[];     // 関連商品ID配列（任意）
}
```

#### キャンペーンデータ

| ID | タイトル | カテゴリー | 期間 |
|----|----------|-----------|------|
| color-stationery | カラー文具特集 | 文具・事務用品 | 2025-10-01 〜 2025-12-31 |
| special-feature | 今月の特集 | - | 2025-10-01 〜 2025-10-31 |
| kitchen-items | キッチン用品フェア | - | 2025-10-01 〜 2025-11-30 |
| sanitization | 除菌・衛生用品特集 | - | 2025-10-01 〜 2025-12-31 |
| tag-collection | タグ・ラベル特集 | - | 2025-10-01 〜 2025-11-30 |
| event-goods | イベント用品 | - | 2025-10-01 〜 2025-12-31 |
| transfer-stationery | 転写文具コレクション | 文具・事務用品 | 2025-10-01 〜 2025-11-30 |

#### 実装ファイル
- `/src/data/campaigns.ts`

#### ヘルパー関数
- `getCampaignById(id: string)`: IDでキャンペーンを取得
- `getFeaturedCampaigns()`: 注目キャンペーンのリストを取得

---

### 2.2 キャンペーン一覧ページ

**要件ID**: CAMP-002
**実装日**: 2025-10-09
**ステータス**: ✅ 完了

#### 概要
全てのキャンペーンをグリッドレイアウトで表示する一覧ページ。

#### 詳細要件

1. **レイアウト**
   - グリッドレイアウト: 1列（モバイル）、2列（タブレット）、3列（デスクトップ）
   - 各キャンペーンカードに画像、タイトル、説明、期間、注目バッジを表示

2. **カード要素**
   - 画像: アスペクト比 16:9
   - タイトル: 太字、1行
   - 説明: 最大3行で切り捨て（`line-clamp-3`）
   - 期間: 開始日〜終了日を日本語形式で表示
   - 注目バッジ: `featured: true` の場合に表示

3. **インタラクション**
   - カード全体がクリッカブル
   - ホバー時にシャドウが拡大
   - クリックで詳細ページに遷移

#### 実装ファイル
- `/src/app/campaigns/page.tsx`

#### URL
- パス: `/campaigns`

---

### 2.3 キャンペーン詳細ページ

**要件ID**: CAMP-003
**実装日**: 2025-10-09
**ステータス**: ✅ 完了

#### 概要
個別キャンペーンの詳細情報と関連商品を表示するページ。

#### 詳細要件

1. **キャンペーン情報表示**
   - 大きなバナー画像（アスペクト比 21:9、`object-fit: contain`）
   - タイトル（H1、3xl、太字）
   - 注目バッジ（featured の場合）
   - 詳細説明（大きめのテキスト、行間広め）
   - メタ情報（期間、カテゴリー）をアイコン付きで表示

2. **関連商品表示**
   - タイトルなしで直接商品リストを表示
   - カテゴリーが設定されている場合、そのカテゴリーの商品を最大9件表示
   - カテゴリーがない場合、全商品から9件表示
   - `ProductListItem` コンポーネントを使用

3. **パンくずリスト**
   - カスタムパンくず: ホーム > キャンペーン一覧 > キャンペーンタイトル

4. **エラーハンドリング**
   - 存在しないキャンペーンIDの場合、エラーメッセージと一覧へのリンクを表示

#### 実装ファイル
- `/src/app/campaigns/[id]/page.tsx`

#### URL
- パス: `/campaigns/[id]`
- 例: `/campaigns/color-stationery`

---

### 2.4 HeroSliderとの連携

**要件ID**: CAMP-004
**実装日**: 2025-10-09
**ステータス**: ✅ 完了

#### 概要
トップページのメインスライダー（HeroSlider）から各キャンペーンページへリンク。

#### 詳細要件

1. **スライダー設定**
   - 7つのスライド、各々キャンペーンに対応
   - 自動再生: 5秒間隔
   - ループ再生: 有効
   - 中央表示、前後スライドを一部表示

2. **リンクマッピング**

| スライド画像 | リンク先 |
|------------|---------|
| top_bnr_color_sta01.png | /campaigns/color-stationery |
| top_bnr_feature01.png | /campaigns/special-feature |
| top_bnr_kitchen.png | /campaigns/kitchen-items |
| top_bnr_m_jyokin03.png | /campaigns/sanitization |
| top_bnr_tag.png | /campaigns/tag-collection |
| top_pro_bnr_event.png | /campaigns/event-goods |
| top_pro_bnr_transfer_sta.png | /campaigns/transfer-stationery |

3. **ユーザーインタラクション**
   - スライドクリックで該当キャンペーンページに遷移
   - アクティブスライドは拡大表示（scale-105）
   - 非アクティブスライドは縮小・半透明（scale-95, opacity-80）

#### 実装ファイル
- `/src/components/home/HeroSlider.tsx`

---

### 2.5 ナビゲーションへの追加

**要件ID**: CAMP-005
**実装日**: 2025-10-09
**ステータス**: ✅ 完了

#### 概要
デスクトップヘッダーとモバイルメニューに「キャンペーン」リンクを追加。

#### 詳細要件

1. **デスクトップヘッダー**
   - 位置: 「商品一覧」と「カテゴリー」の間
   - スタイル: 他のナビゲーションリンクと統一

2. **モバイルメニュー**
   - 位置: 「商品一覧」の直後
   - アイコン: タグアイコン（SVG）
   - スタイル: 他のメニュー項目と統一

#### 実装ファイル
- `/src/components/layout/Header.tsx` (デスクトップ)
- `/src/components/layout/MobileMenu.tsx` (モバイル)

---

## ユーザーアカウント管理

### 3.1 アカウント設定ページ

**要件ID**: USER-001
**実装日**: 2025-10-09
**ステータス**: ✅ 完了

#### 概要
ユーザーが自身のプロフィール情報、配送先住所、パスワード、通知設定を管理できる包括的な設定ページ。

#### セクション構成

##### 3.1.1 プロフィール情報編集

**フィールド**:
- お名前（必須）
- お名前（カナ）（任意）
- メールアドレス（必須）
- 電話番号（任意）

**要件**:
- Zustand storeの `updateUser` 関数で保存
- 既存のユーザー情報を自動的にフォームに反映
- 保存成功時にtoast通知

##### 3.1.2 配送先住所管理

**フィールド**:
- 郵便番号（任意）
- 都道府県（任意）
- 市区町村（任意）
- 町名・番地（任意）
- 建物名・部屋番号（任意）

**要件**:
- Zustand storeの `updateUser` 関数で保存
- プレースホルダーで入力例を表示
- 保存成功時にtoast通知

##### 3.1.3 パスワード変更

**フィールド**:
- 現在のパスワード（必須）
- 新しいパスワード（必須、8文字以上）
- 新しいパスワード（確認）（必須、8文字以上）

**バリデーション**:
- 新しいパスワードが8文字未満の場合、エラー表示
- 新しいパスワードと確認パスワードが一致しない場合、エラー表示
- 変更成功後、フォームをクリア

**要件**:
- 実際のAPI呼び出しは今後実装
- 現在はフロントエンドのみでバリデーション

##### 3.1.4 メール通知設定

**設定項目**:
- 注文状況の更新（デフォルト: ON）
- プロモーション情報（デフォルト: ON）
- ニュースレター（デフォルト: OFF）

**UI**:
- トグルスイッチで ON/OFF 切り替え
- 各設定に説明テキストを表示
- Tailwind CSS の peer セレクタで実装

**要件**:
- 実際のAPI呼び出しは今後実装
- 保存成功時にtoast通知

##### 3.1.5 アカウント削除

**要件**:
- 危険な操作として赤枠で強調表示
- クリック時に確認ダイアログ表示
- 現在は準備中のメッセージのみ表示
- 実際の削除機能は今後実装

#### 実装ファイル
- `/src/app/mypage/settings/page.tsx`

#### URL
- パス: `/mypage/settings`

#### 認証
- 未認証ユーザーは自動的にログインページにリダイレクト
- `useAuthStore` で認証状態を確認

#### 技術仕様
- `useState` で各フォームの状態を管理
- `useEffect` でユーザー情報をフォームに反映
- react-hot-toast で通知表示
- レスポンシブデザイン（モバイル/タブレット/デスクトップ対応）

---

## UI/UXの改善

### 4.1 z-index階層管理

**要件ID**: UI-001
**実装日**: 2025-10-09
**ステータス**: ✅ 完了

#### 概要
ページ内の要素が正しい重なり順で表示されるよう、z-indexを体系的に管理。

#### z-index階層定義

| 要素 | z-index | 用途 |
|-----|---------|-----|
| HeroSlider | `z-0` | メインコンテンツ（最下層） |
| Header (全体) | `z-40` | ヘッダーの基本レイヤー |
| Header (固定時) | `z-50` | スクロール時の固定ヘッダー |
| Navigation | `z-[60]` | ナビゲーションバー |
| Dropdown | `z-[9999]` | カテゴリードロップダウン（最上層） |

#### 実装方針
- 最小限のz-indexを使用
- 明確な階層構造を維持
- コメントで各z-indexの目的を記載

#### 実装ファイル
- `/src/components/layout/Header.tsx`
- `/src/components/home/HeroSlider.tsx`

---

## 今後の拡張計画

### 追加予定の機能

1. **キャンペーン機能の拡張**
   - [ ] キャンペーン検索機能
   - [ ] カテゴリーフィルター
   - [ ] 開催中/終了済みフィルター
   - [ ] キャンペーンのお気に入り登録

2. **アカウント管理の拡張**
   - [ ] 複数配送先住所の管理
   - [ ] お支払い方法の登録・管理
   - [ ] アカウント削除機能の実装
   - [ ] プロフィール画像のアップロード
   - [ ] APIとの連携

3. **ナビゲーションの改善**
   - [ ] メガメニュー形式への拡張
   - [ ] 最近見た商品の表示
   - [ ] おすすめカテゴリーの動的表示

---

## 変更履歴

### 2025-10-09
- 初版作成
- ナビゲーション機能（パンくずリスト、カテゴリードロップダウン）
- キャンペーン機能（データモデル、一覧ページ、詳細ページ、HeroSlider連携）
- ユーザーアカウント管理（アカウント設定ページ）
- UI/UX改善（z-index階層管理）

---

## ドキュメント管理

### 更新ルール

1. **新機能追加時**
   - 新しいセクションを追加
   - 要件ID、実装日、ステータスを記載
   - 詳細要件と実装ファイルを明記

2. **既存機能変更時**
   - 該当セクションを更新
   - 変更履歴に記録

3. **機能廃止時**
   - ステータスを「❌ 廃止」に変更
   - 廃止理由を記載

### ステータス定義

- ✅ 完了: 実装済み、本番稼働中
- 🚧 開発中: 実装作業進行中
- 📋 計画中: 要件定義済み、実装待ち
- ❌ 廃止: 削除または無効化済み

---

## 参考資料

- [開発ガイドライン](/docs/nextjs-version/DEVELOPMENT_GUIDELINES.md)
- [親子テーマアーキテクチャ実装ガイド](/docs/nextjs-version/guidelines/PARENT_CHILD_IMPLEMENTATION_GUIDE.md)
- [デザインシステム](/docs/nextjs-version/DESIGN_SYSTEM.md)
